{{- /* themes/overrides/layouts/_default/_markup/render-link.html */ -}}
{{- $dest := .Destination -}}

{{- /* Default to a semantic class; allow override via params if needed */ -}}
{{- $baseClasses := .Page.Site.Params.text.linkClasses | default "link-brand font-bold no-underline hover:underline" -}}
{{- /* Brand-aware text color classes (server-side) */ -}}
{{- $brandClasses := partial "theme/link-brand-classes.html" .Page -}}
{{- $linkClasses := printf "%s %s" $baseClasses $brandClasses -}}

{{- /* .md â†’ pretty URL normalization */ -}}
{{- $href := $dest -}}
{{- if and (not (or (strings.HasPrefix $dest "http://") (strings.HasPrefix $dest "https://"))) (strings.HasSuffix (lower $dest) ".md") -}}
  {{- $url := replaceRE `(?i)\.md$` "" $dest -}}
  {{- $url = replaceRE `^\.{1,2}/` "" $url -}}
  {{- if not (strings.HasPrefix $url "/") -}} {{- $url = printf "/%s" $url -}} {{- end -}}
  {{- if not (strings.HasSuffix $url "/") -}} {{- $url = printf "%s/" $url -}} {{- end -}}
  {{- $url = replaceRE "/+" "/" $url -}}
  {{- $href = $url -}}
{{- end -}}

{{- /* External links: open in new tab + noopener */ -}}
{{- $isExternal := or (strings.HasPrefix $href "http://") (strings.HasPrefix $href "https://") -}}

<a href="{{ $href | safeURL }}" class="{{ $linkClasses }}"{{ with .Title }} title="{{ . }}"{{ end }}{{ if $isExternal }} target="_blank" rel="noopener noreferrer"{{ end }}>{{ .Text | safeHTML }}</a>
