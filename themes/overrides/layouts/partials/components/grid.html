{{- /* Grid: fluid auto-fit columns (no breakpoints) */ -}}
{{- $id := .id -}}
{{- $tag := .tag | default "div" -}}
{{- $min := .min | default "16rem" -}}
{{- $gap := .gap | default "1.5rem" -}}
{{- $v   := .v   | default "top" -}}
{{- $ji  := .ji  | default "" -}}
{{- $ai  := .ai  | default "" -}}
{{- $al  := or (.h) (.align) | default "left" -}}
{{- $max := .max | default "xl" -}}
{{- $px  := .px  | default "lg" -}}
{{- $py  := .py  | default "none" -}}

{{- $maxMap := dict "sm" "max-w-screen-sm" "md" "max-w-3xl" "lg" "max-w-5xl" "xl" "max-w-7xl" "2xl" "max-w-screen-2xl" "full" "max-w-none" -}}
{{- $pxMap  := dict "none" "px-0" "sm" "px-4" "md" "px-6" "lg" "px-8" -}}
{{- $pyMap  := dict "none" "py-0" "sm" "py-6" "md" "py-12" "lg" "py-16" "xl" "py-24" -}}
{{- $alMap  := dict "left" "text-left" "center" "text-center" "right" "text-right" -}}

{{- $vCols  := dict "top" "" "center" "v-center" "end" "v-end" "stretch" "v-stretch" -}}
{{- $vClass := index $vCols $v | default "" -}}

{{- $jiMap := dict "left" "ji-left" "center" "ji-center" "right" "ji-right" "stretch" "ji-stretch" -}}
{{- $aiMap := dict "top" "ai-top" "center" "ai-center" "end" "ai-end" "stretch" "ai-stretch" -}}
{{- $jiClass := cond (isset $jiMap $ji) (index $jiMap $ji) "" -}}
{{- $aiClass := cond (isset $aiMap $ai) (index $aiMap $ai) "" -}}

{{- $base := printf "%s mx-auto %s %s %s cols-auto %s %s %s"
    (index $maxMap $max | default "max-w-7xl")
    (index $pxMap  $px  | default "px-8")
    (index $pyMap  $py  | default "py-0")
    (index $alMap  $al  | default "text-left")
    $vClass $jiClass $aiClass
-}}

{{- $siteOverride := site.Params.grid.classes | default "" -}}
{{- $pageOverride := .classes | default "" -}}
{{- $classes := cond (ne $pageOverride "") $pageOverride (cond (ne $siteOverride "") $siteOverride $base) -}}

{{- $innerRS := .Page.RenderString .Inner -}}
{{- $inner   := cond (gt (len (trim $innerRS " \n\r\t")) 0) $innerRS (.Inner | markdownify) -}}

<{{ $tag }}{{ with $id }} id="{{ . }}"{{ end }}
  class="{{ $classes }}"
  style="--min: {{ $min }}; --gap: {{ $gap }};">
  {{- $inner | safeHTML -}}
</{{ $tag }}>
