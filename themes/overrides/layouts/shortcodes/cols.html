{{- /* layouts/shortcodes/cols.html
     Auto-fit grid (wraps to new rows). Control X/Y gaps separately.
     Props:
       min="16rem"       → minimum tile width
       gap="1.5rem"      → column gap
       row="md"          → row gap: none|sm|md|lg|xl or any CSS length (e.g. 2rem)
       v="start|center|end|stretch" → per-row vertical alignment (default stretch)
       classes="…"       → extra classes on the grid wrapper

     .cols-auto CSS should define:
       display:grid;
       grid-template-columns: repeat(auto-fit, minmax(var(--min,16rem), 1fr));
       gap: var(--gap, 1.5rem);
       row-gap: var(--row, var(--gap, 1.5rem));
*/ -}}

{{- $min    := .Get "min"    | default "16rem" -}}
{{- $gap    := .Get "gap"    | default "1.5rem" -}}
{{- $rowArg := lower (.Get "row" | default "") -}}
{{- $v      := lower (.Get "v"   | default "stretch") -}}
{{- $order  := lower (.Get "order" | default "") -}}
{{- $extra  := .Get "classes"| default "" -}}

{{- $motionEnabled := .Page.Site.Params.motion.enabled | default false -}}

{{- $vMap := dict
  "start"   "items-start"
  "center"  "items-center"
  "end"     "items-end"
  "stretch" "items-stretch"
-}}
{{- $vCls := index $vMap $v | default "items-stretch" -}}

{{- $yMap := dict "none" "0" "sm" "1.5rem" "md" "3rem" "lg" "4rem" "xl" "6rem" -}}
{{- $row := "" -}}
{{- if $rowArg -}}
  {{- if isset $yMap $rowArg -}}
    {{- $row = index $yMap $rowArg -}}
  {{- else -}}
    {{- $row = $rowArg -}}
  {{- end -}}
{{- end -}}

{{- $orderCls := "" -}}
{{- if eq $order "reverse" -}}
  {{- /* Reverse visual order on mobile by switching to a flex column-reverse layout under md, then grid at md+ */ -}}
  {{- $orderCls = "cols-reverse-mobile" -}}
{{- end -}}

<div class="cols-auto {{ $vCls }}{{ if $orderCls }} {{ $orderCls }}{{ end }}{{ with $extra }} {{ . }}{{ end }}"{{ if $motionEnabled }} data-motion-group="stagger"{{ end }}
     style="--min: {{ $min }}; --gap: {{ $gap }};{{ if $row }} --row: {{ $row }};{{ end }}">
  {{ .Inner }}
</div>
