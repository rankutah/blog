{{/* Shortcode: problem
   Usage:
   {{< problem title="Clogged / Overflowing" icon="clogged" problem="Leaves and debris block flow causing overflow & fascia rot." solution="Install guards, seasonal cleaning, clear valleys to maintain pitch & capacity." >}}

   Params:
     title    (string)  – Heading
     problem  (string)  – Problem description
     solution (string)  – Solution description
     icon     (string)  – One of: clogged | sagging | leak | loose | drain | underground | staining | fascia
     classes  (string)  – Extra utility classes (optional)
*/}}

{{ $title    := .Get "title"    | default "Untitled" }}
{{ $prob     := .Get "problem"  | default "" }}
{{ $sol      := .Get "solution" | default "" }}
{{ $iconName := lower (.Get "icon" | default "clogged") }}
{{ $extra    := .Get "classes" | default "" }}
{{ $img      := .Get "img" | default "" }}
{{ $alt      := .Get "alt" | default $title }}

{{/* Icon library (inline SVG for clarity; simple two-tone) */}}
{{ $svg := "" }}
{{ if eq $iconName "clogged" }}
  {{ $svg = `
<svg viewBox="0 0 128 128" class="w-28 h-28" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
  <rect x="8" y="36" width="112" height="28" rx="4" fill="currentColor" fill-opacity="0.06" />
  <path d="M12 40h104" />
  <path d="M24 64v10c0 10 12 18 24 18s24-8 24-18V64" />
  <path d="M72 64v10c0 10 12 18 24 18s24-8 24-18V64" />
  <path d="M24 52l6 4m8-4l6 4m8-4l6 4m8-4l6 4m8-4l6 4" />
  <path d="M20 86l10 6m10 6l10 6" stroke-opacity="0.35" />
</svg>` }}
{{ else if eq $iconName "sagging" }}
  {{ $svg = `
<svg viewBox="0 0 128 128" class="w-28 h-28" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
  <path d="M12 40h104" />
  <path d="M16 44c8 24 32 36 48 36s40-12 48-36" fill="currentColor" fill-opacity="0.06" />
  <path d="M24 80v12m80-12v12" />
</svg>` }}
{{ else if eq $iconName "leak" }}
  {{ $svg = `
<svg viewBox="0 0 128 128" class="w-28 h-28" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
  <rect x="8" y="36" width="112" height="28" rx="4" fill="currentColor" fill-opacity="0.06" />
  <path d="M12 40h104" />
  <path d="M64 64c0 8-6 16-12 24-6 8 2 16 12 16s18-8 12-16c-6-8-12-16-12-24z" fill="currentColor" fill-opacity="0.1" />
</svg>` }}
{{ else if eq $iconName "loose" }}
  {{ $svg = `
<svg viewBox="0 0 128 128" class="w-28 h-28" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
  <rect x="16" y="32" width="80" height="32" rx="4" fill="currentColor" fill-opacity="0.06" />
  <path d="M24 64v36" />
  <path d="M96 64v20c0 13-10 24-24 24H24" />
  <path d="M44 44l-4 8m20-8l-4 8m20-8l-4 8" />
</svg>` }}
{{ else if eq $iconName "drain" }}
  {{ $svg = `
<svg viewBox="0 0 128 128" class="w-28 h-28" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
  <rect x="12" y="28" width="104" height="32" rx="4" fill="currentColor" fill-opacity="0.06" />
  <path d="M16 32h96" />
  <path d="M40 60v24c0 8 6 12 12 12h12c8 0 12 6 12 12v8" />
  <path d="M72 60v12c0 8 6 12 12 12h20" />
</svg>` }}
{{ else if eq $iconName "underground" }}
  {{ $svg = `
<svg viewBox="0 0 128 128" class="w-28 h-28" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
  <path d="M16 28h96v28H16z" fill="currentColor" fill-opacity="0.06" />
  <path d="M28 56v24c0 8 6 12 12 12h24c8 0 12 6 12 12v12" />
  <circle cx="92" cy="108" r="12" fill="currentColor" fill-opacity="0.1" />
  <path d="M86 102l12 12" />
</svg>` }}
{{ else if eq $iconName "staining" }}
  {{ $svg = `
<svg viewBox="0 0 128 128" class="w-28 h-28" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
  <rect x="8" y="36" width="112" height="28" rx="4" fill="currentColor" fill-opacity="0.06" />
  <path d="M12 40h104" />
  <path d="M24 52c6 2 8 6 6 10m16-10c6 2 8 6 6 10m16-10c6 2 8 6 6 10m16-10c6 2 8 6 6 10" />
</svg>` }}
{{ else if eq $iconName "fascia" }}
  {{ $svg = `
<svg viewBox="0 0 128 128" class="w-28 h-28" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
  <path d="M8 36h112v28H8z" fill="currentColor" fill-opacity="0.06" />
  <path d="M12 40h104" />
  <path d="M20 64v28h32l12-12" />
  <path d="M84 64v20l12 12h-28" />
</svg>` }}
{{ else }}
  {{ $svg = "" }}
{{ end }}

<div class="flex flex-col md:flex-row rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 overflow-hidden mb-8 {{ $extra }}">
  <div class="md:w-1/3 w-full flex items-center justify-center bg-gray-50 dark:bg-gray-900/40">
    {{ if $img }}
      <img src="{{ $img }}" alt="{{ $alt }}" class="w-full h-full object-cover" loading="lazy" decoding="async" />
    {{ else }}
      <div class="p-6 text-red-600 dark:text-red-500">{{ $svg | safeHTML }}</div>
    {{ end }}
  </div>
  <div class="md:w-2/3 w-full p-6 flex flex-col justify-center gap-3">
    <h2 class="text-xl md:text-2xl font-semibold leading-tight">{{ $title }}</h2>
    {{ if $prob }}<p><span class="font-semibold text-red-600 dark:text-red-400">Problem</span> {{ $prob }}</p>{{ end }}
    {{ if $sol }}<p><span class="font-semibold text-green-600 dark:text-green-400">Solution</span> {{ $sol }}</p>{{ end }}
  </div>
</div>
